<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <meta name="theme-color" content="#1B6AA5" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <title>وسيلة — تطبيق سيارات الحوض</title>

  <!-- خط عربي -->
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;600;700;800&display=swap" rel="stylesheet">

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ['Tajawal','ui-sans-serif','system-ui'] },
          colors: {
            waseela: { primary:'#1B6AA5', secondary:'#10B981', ink:'#0f172a' }
          },
          boxShadow:{ soft:'0 12px 30px rgba(27,106,165,.12)' },
          borderRadius:{ '2xl':'1rem' }
        }
      }
    }
  </script>

  <!-- Leaflet (خريطة) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    html,body { height:100%; background:#f7fafc }
    body { font-family:"Tajawal",sans-serif }
    #app { min-height:100%; padding-bottom: 64px } /* مساحة للتاب بار */
    #map { height: calc(100dvh - 56px - 16px - 140px); border-radius: 16px; }
    @media (min-width:768px){ #map { height: calc(100dvh - 56px - 16px - 180px); } }
    .grad-primary{ background: linear-gradient(135deg,#1B6AA5 0%, #0ea5e9 50%, #10B981 100%) }
    .safe-top{ padding-top: env(safe-area-inset-top) }
    .safe-bottom{ padding-bottom: env(safe-area-inset-bottom) }
    .sheet{ position: fixed; inset-inline: 0; bottom: 56px; z-index: 30 }
    .sheet-card{ border-top-left-radius: 18px; border-top-right-radius: 18px }
    .drag-handle{ width: 40px; height: 4px; background:#cbd5e1; border-radius: 999px; margin: 8px auto }
    .tabbar{ height:56px }
  </style>
</head>
<body class="text-waseela-ink">
  <div id="app" class="safe-top">

    <!-- Header (تصميم تطبيق) -->
    <header class="px-4 py-2 bg-white shadow-sm sticky top-0 z-40">
      <div class="max-w-screen-md mx-auto flex items-center justify-between">
        <div class="flex items-center gap-2">
          <span class="inline-flex items-center justify-center w-9 h-9 rounded-xl grad-primary shadow-soft">
            <svg viewBox="0 0 24 24" class="w-5 h-5 text-white" fill="currentColor" aria-hidden="true">
              <path d="M3 13.5a2.5 2.5 0 1 0 2.45 2H18a2.5 2.5 0 1 0 2.45-2H21v-2.25a2.25 2.25 0 0 0-2.25-2.25H15V6.75A1.75 1.75 0 0 0 13.25 5h-2.5A1.75 1.75 0 0 0 9 6.75V9H5.25A2.25 2.25 0 0 0 3 11.25V13.5Zm6-4.5V6.75c0-.138.112-.25.25-.25h2.5c.138 0 .25.112.25.25V9H9Z"/>
            </svg>
          </span>
          <div>
            <div class="text-lg font-extrabold tracking-tight text-waseela-primary">وسيلة</div>
            <div class="text-[11px] -mt-0.5 text-gray-500">تشغيل سيارات الحوض</div>
          </div>
        </div>

        <button id="ctaTop" class="px-3 py-2 rounded-lg text-white grad-primary text-sm shadow-soft">طلب حوض</button>
      </div>
    </header>

    <!-- محتوى رئيسي (خريطة + كروت) -->
    <main class="px-4 pt-3 pb-4 max-w-screen-md mx-auto">
      <!-- كارد مختصر -->
      <section class="bg-white rounded-2xl shadow-soft p-4 mb-3">
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm text-gray-500">موقعك التقريبي</div>
            <div class="font-bold">الرياض</div>
          </div>
          <button id="locateBtn" class="text-blue-600 text-sm underline">تحديد الموقع</button>
        </div>
      </section>

      <!-- خريطة -->
      <section class="bg-white rounded-2xl shadow-soft p-2">
        <div id="map" class="w-full"></div>
        <div class="px-2 py-2 text-[12px] text-gray-500">انقر على الخريطة لاختيار نقطة. السحب للتكبير/التصغير.</div>
      </section>

      <!-- بطاقات مميزات (شكل تطبيق) -->
      <section class="mt-3 grid grid-cols-3 gap-3">
        <div class="bg-white rounded-xl p-3 text-center shadow">
          <div class="w-8 h-8 rounded-lg grad-primary text-white mx-auto flex items-center justify-center">
            <svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M6 2a1 1 0 0 0-1 1v2H3.5A1.5 1.5 0 0 0 2 6.5v11A1.5 1.5 0 0 0 3.5 19H5v2a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2h1.5a1.5 1.5 0 0 0 1.5-1.5v-11A1.5 1.5 0 0 0 19.5 5H19V3a1 1 0 0 0-1-1H6Zm0 4h12v12H6V6Z"/></svg>
          </div>
          <div class="mt-2 text-[12px] font-semibold">حجز سريع</div>
        </div>
        <div class="bg-white rounded-xl p-3 text-center shadow">
          <div class="w-8 h-8 rounded-lg grad-primary text-white mx-auto flex items-center justify-center">
            <svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M12 1a11 11 0 1 0 11 11A11.013 11.013 0 0 0 12 1Zm1 11.414V6a1 1 0 0 0-2 0v7a1 1 0 0 0 .293.707l4 4a1 1 0 1 0 1.414-1.414Z"/></svg>
          </div>
          <div class="mt-2 text-[12px] font-semibold">استجابة فورية</div>
        </div>
        <div class="bg-white rounded-xl p-3 text-center shadow">
          <div class="w-8 h-8 rounded-lg grad-primary text-white mx-auto flex items-center justify-center">
            <svg viewBox="0 0 24 24" class="w-5 h-5" fill="currentColor"><path d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm1 5.5a1 1 0 1 0-2 0V12a1 1 0 0 0 .293.707l3 3a1 1 0 0 0 1.414-1.414L13 11.586Z"/></svg>
          </div>
          <div class="mt-2 text-[12px] font-semibold">تتبع مباشر</div>
        </div>
      </section>
    </main>

    <!-- Bottom Sheet (فورم الحجز) -->
    <div class="sheet px-3 safe-bottom" id="sheet">
      <div class="sheet-card bg-white shadow-2xl border border-gray-100 max-w-screen-md mx-auto">
        <div class="drag-handle"></div>
        <div class="p-4">
          <div class="flex items-center justify-between mb-2">
            <h2 class="text-base font-extrabold">طلب حوض</h2>
            <button id="closeSheet" class="text-gray-500 text-sm">إخفاء</button>
          </div>

          <div class="grid grid-cols-2 gap-3 text-sm">
            <div class="col-span-2">
              <label class="block text-gray-700">التحميل</label>
              <input id="pickup" type="text" placeholder="مثال: مستودع شمال"
                     class="mt-1 w-full border rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-waseela-primary/40"/>
            </div>
            <div class="col-span-2">
              <label class="block text-gray-700">التفريغ</label>
              <input id="drop" type="text" placeholder="مثال: صناعية السلي"
                     class="mt-1 w-full border rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-waseela-primary/40"/>
            </div>
            <div>
              <label class="block text-gray-700">الوزن (كجم)</label>
              <input id="weight" type="number" placeholder="800"
                     class="mt-1 w-full border rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-waseela-primary/40"/>
            </div>
            <div>
              <label class="block text-gray-700">التاريخ</label>
              <input id="date" type="datetime-local"
                     class="mt-1 w-full border rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-waseela-primary/40"/>
            </div>
            <div class="col-span-2">
              <label class="block text-gray-700">ملاحظات</label>
              <textarea id="notes" rows="2" placeholder="تفاصيل إضافية…"
                        class="mt-1 w-full border rounded-xl p-3 focus:outline-none focus:ring-2 focus:ring-waseela-primary/40"></textarea>
            </div>
          </div>

          <button id="bookBtn"
                  class="mt-3 w-full px-6 py-3 rounded-xl text-white grad-primary shadow-soft">
            تأكيد الحجز
          </button>

          <div id="result" class="hidden mt-3 p-3 rounded-xl bg-emerald-50 text-emerald-900 border border-emerald-200 text-sm"></div>
        </div>
      </div>
    </div>

    <!-- Bottom Tab Bar -->
    <nav class="tabbar fixed bottom-0 inset-x-0 bg-white border-t shadow-sm z-40 safe-bottom">
      <div class="max-w-screen-md mx-auto grid grid-cols-4">
        <button class="py-2 flex flex-col items-center gap-0.5 text-blue-600" id="tabHome">
          <svg viewBox="0 0 24 24" class="w-6 h-6" fill="currentColor"><path d="M12 3l9 8h-3v9H6v-9H3l9-8z"/></svg>
          <span class="text-[11px]">الرئيسية</span>
        </button>
        <button class="py-2 flex flex-col items-center gap-0.5 text-gray-600" id="tabOrders">
          <svg viewBox="0 0 24 24" class="w-6 h-6" fill="currentColor"><path d="M7 4h10a2 2 0 0 1 2 2v14l-7-3-7 3V6a2 2 0 0 1 2-2z"/></svg>
          <span class="text-[11px]">طلباتي</span>
        </button>
        <button class="py-2 flex flex-col items-center gap-0.5 text-gray-600" id="tabWallet">
          <svg viewBox="0 0 24 24" class="w-6 h-6" fill="currentColor"><path d="M2 7a3 3 0 0 1 3-3h13a2 2 0 0 1 2 2v2h-2V6H5a1 1 0 0 0-1 1v1h15a2 2 0 0 1 2 2v7a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V7z"/></svg>
          <span class="text-[11px]">المحفظة</span>
        </button>
        <button class="py-2 flex flex-col items-center gap-0.5 text-gray-600" id="tabProfile">
          <svg viewBox="0 0 24 24" class="w-6 h-6" fill="currentColor"><path d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5.33 0-8 2.667-8 6v2h16v-2c0-3.333-2.67-6-8-6z"/></svg>
          <span class="text-[11px]">حسابي</span>
        </button>
      </div>
    </nav>

  </div>

  <!-- Scripts -->
  <script>
    // خريطة
    const map = L.map('map', { zoomControl:false }).setView([24.7136,46.6753], 11)
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
      attribution: '© OpenStreetMap'
    }).addTo(map)
    let marker
    map.on('click', e => {
      if (marker) marker.remove()
      marker = L.marker(e.latlng).addTo(map)
    })

    // Bottom Sheet منطق بسيط
    const sheet = document.getElementById('sheet')
    const openSheet = () => { sheet.style.display='block' }
    const closeSheet = () => { sheet.style.display='none' }
    document.getElementById('ctaTop').addEventListener('click', openSheet)
    document.getElementById('closeSheet').addEventListener('click', closeSheet)

    // زر تحديد الموقع (تجريبي)
    document.getElementById('locateBtn').addEventListener('click', ()=>{
      if(navigator.geolocation){
        navigator.geolocation.getCurrentPosition(pos=>{
          const {latitude,longitude} = pos.coords
          map.setView([latitude,longitude], 13)
          if (marker) marker.remove()
          marker = L.marker([latitude,longitude]).addTo(map)
        })
      } else {
        alert('المتصفح لا يدعم تحديد الموقع')
      }
    })

    // حجز وهمي
    const bookBtn = document.getElementById('bookBtn')
    const result = document.getElementById('result')
    bookBtn.addEventListener('click', () => {
      const pickup = document.getElementById('pickup').value.trim()
      const drop = document.getElementById('drop').value.trim()
      const weight = document.getElementById('weight').value
      if(!pickup || !drop){ alert('يرجى إدخال مواقع التحميل والتفريغ'); return }
      const id = 'R-' + Math.floor(Math.random()*9000+1000)
      result.textContent = `تم إنشاء الحجز: ${id} — وزن: ${weight||0} كجم`
      result.classList.remove('hidden')
    })

    // تبويب سفلي (عرض توست بسيط)
    const tabs = ['tabHome','tabOrders','tabWallet','tabProfile']
    tabs.forEach(id=>{
      document.getElementById(id).addEventListener('click', ()=>{
        if(id==='tabHome'){ window.scrollTo({top:0,behavior:'smooth'}) }
        else alert('هذه الواجهة تجريبية — سيتم تفعيلها لاحقًا.')
      })
    })

    // فتح فورم عند دخول الصفحة على الجوال ليسهل الاستخدام
    if (window.matchMedia('(max-width: 640px)').matches) openSheet()
  </script>
</body>
</html>
